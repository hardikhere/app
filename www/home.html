<!DOCTYPE html>

<html>
    <head>
      
        <meta http-equiv="Content-Security-Policy" content="default-src * self blob: data: gap:; style-src * self 'unsafe-inline' blob: data: gap:; script-src * 'self' 'unsafe-eval' 'unsafe-inline' blob: data: gap:; object-src * 'self' blob:
         data: gap:; img-src * self 'unsafe-inline' blob: data: gap:; connect-src self * 'unsafe-inline' blob: data: gap:; frame-src * self blob: data: gap:;">
        <meta name="format-detection" content="telephone=no">
        <meta name="msapplication-tap-highlight" content="no">
        <meta name="viewport" content="initial-scale=1, width=device-width, viewport-fit=cover">
        <link rel="stylesheet" type="text/css" href="css/index.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@ionic/core/css/ionic.bundle.css"/>
        <title>Home</title>
    </head>
    <body>
        <div class="app">

            <div id="deviceready" >
                
                <script type="module" src="https://cdn.jsdelivr.net/npm/@ionic/core/dist/ionic/ionic.esm.js"></script>
                <script nomodule src="https://cdn.jsdelivr.net/npm/@ionic/core/dist/ionic/ionic.js"></script>
           
                <ion-grid>
                    <ion-row>
                        <ion-col>
                            <ion-segment scrollable value="cycles">
                                <ion-segment-button value="cycles">
                                  <ion-label>Cycles</ion-label>
                                </ion-segment-button>
                                <ion-segment-button value="profile">
                                  <ion-label>Profile</ion-label>
                                </ion-segment-button>
                              </ion-segment>
                        </ion-col>
                    </ion-row>
                   
                           
                    
                </ion-grid>
                         
               
                     
                </div>
            </div>
            <ion-content>
              <ion-spinner id="mainSpinner" class="text-center" name="crescent"></ion-spinner>
                <div class="Profile">
                             
                </div>
                <ion-infinite-scroll>
                  <ion-infinite-scroll-content>
                    <div class="mainContent">
                             
                    </div>
                  </ion-infinite-scroll-content>
                </ion-infinite-scroll>
                
              </ion-content>
       
        <script type="text/javascript" src="cordova.js"></script>
        <script type="text/javascript" src="js/index.js"></script>
    </body>

    
    
<script src="https://www.gstatic.com/firebasejs/7.15.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/7.15.0/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/7.15.0/firebase-firestore.js"></script>
<script>
    var main = document.querySelector('.mainContent');
    var profile = document.querySelector('.Profile');

    const firebaseConfig = {
apiKey: "AIzaSyDNaNRZSLk96eHP9_4JQ7HYubpCnVq8IAc",
authDomain: "bicycle-app-f3005.firebaseapp.com",
databaseURL: "https://bicycle-app-f3005.firebaseio.com",
projectId: "bicycle-app-f3005",
storageBucket: "bicycle-app-f3005.appspot.com",
messagingSenderId: "19986827976",
appId: "1:19986827976:web:41f47defbff90c481b33fd"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();
const cycles = [];
var newCardList;

db.collection("All")
    .get()
    .then(function(querySnapshot) {
        querySnapshot.forEach(function(doc) {
            // doc.data() is never undefined for query doc snapshots
            console.log(doc.id, " => ", doc.data());
            cycles.push(doc);
        });
        console.log(cycles);
        var cardList = cycles.map(data =>{
            return `
            <ion-card>
  <ion-card-header>
    <ion-card-subtitle>$78</ion-card-subtitle>
    <ion-card-title>${data.id}</ion-card-title>
  </ion-card-header>
   <img src = ${data.data().img}>
   <ion-button> Assign</ion-button>
</ion-card>
            `
        }).join(" ");
        main.innerHTML = cardList;
        newCardList = cardList;
        const mainSpinner = document.querySelector("#mainSpinner");
        mainSpinner.style.display = "none";
    })
    .catch(function(error) {
        console.log("Error getting documents: ", error);
    });


    const segments = document.querySelectorAll('ion-segment');
    
    var storage = window.localStorage;
    var profileCard = `
    
    <ion-card>
       <ion-row>
        <ion-col size="3">
            <ion-avatar class="ion-margin-start">
           <img src="img/avatar.svg">
           </ion-avatar>
        </ion-col>
        
       
        <ion-col>
  <ion-card-header>
    <ion-card-subtitle>${storage.getItem("UserEmail")}</ion-card-subtitle>
    <ion-card-title>${storage.getItem("UserName")}</ion-card-title>
  </ion-card-header>

  <ion-card-content>
     No cycle assigned
  </ion-card-content>
  </ion-col>
</ion-row>
</ion-card>
    `;
for (let i = 0; i < segments.length; i++) {
  segments[i].addEventListener('ionChange', (ev) => {
    if( ev.detail.value==="profile"){
        main.innerHTML = "";
        profile.innerHTML = profileCard;
    }else {
        profile.innerHTML = "";
        main.innerHTML = newCardList;}
    
  })
}
</script>

</html>
