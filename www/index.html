<!DOCTYPE html>

<html>
    <head>
      
        <meta http-equiv="Content-Security-Policy" content="default-src * self blob: data: gap:; style-src * self 'unsafe-inline' blob: data: gap:; script-src * 'self' 'unsafe-eval' 'unsafe-inline' blob: data: gap:; object-src * 'self' blob:
         data: gap:; img-src * self 'unsafe-inline' blob: data: gap:; connect-src self * 'unsafe-inline' blob: data: gap:; frame-src * self blob: data: gap:;">
        <meta name="format-detection" content="telephone=no">
        <meta name="msapplication-tap-highlight" content="no">
        <meta name="viewport" content="initial-scale=1, width=device-width, viewport-fit=cover">
        <link rel="stylesheet" type="text/css" href="css/index.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@ionic/core/css/ionic.bundle.css"/>
        <title>Login</title>
    </head>
    <body>
        <div class="app">

            <div id="deviceready" >
                
                <script type="module" src="https://cdn.jsdelivr.net/npm/@ionic/core/dist/ionic/ionic.esm.js"></script>
                <script nomodule src="https://cdn.jsdelivr.net/npm/@ionic/core/dist/ionic/ionic.js"></script>
           
                <p class="event listening">Connecting to Device</p>
                <div class="event received">
                    <ion-grid>
                       
                        <ion-header>
                          <ion-toolbar>
                            <ion-buttons slot="start">
                              <ion-back-button></ion-back-button>
                            </ion-buttons>
                            <ion-title size="large">Login</ion-title>
                            
                          </ion-toolbar>
                        
                        </ion-header>
                        <ion-spinner id="spinner" name="circles" color="primary" style="
                        display: none;"></ion-spinner>
                        <ion-row>
                          <ion-col>
                            <ion-item>
                              <ion-label position="floating">Email</ion-label>
                              <ion-input id="emailLogin" placeholder="Enter Email"></ion-input>
                            </ion-item>
                          </ion-col>
                        </ion-row>
                        <ion-row>
                          <ion-col>
                            <ion-item>
                              <ion-label position="floating">Password</ion-label>
                              <ion-input id="passwordLogin" placeholder="Enter Password"></ion-input>
                            </ion-item>
                          </ion-col>
                        </ion-row>
                        <ion-row>
                          <ion-col>
                            
                              <ion-button onclick="handleSigninBtn(event)" color="primary">Login</ion-button>
                              <ion-button href="signup.html" color="primary">Signup</ion-button>
                            
                          </ion-col>
                        </ion-row>
                      </ion-grid>

                </div>
            </div>
        </div>
        <script type="text/javascript" src="cordova.js"></script>
        <script type="text/javascript" src="js/index.js"></script>
    </body>

    
    
<script src="https://www.gstatic.com/firebasejs/7.15.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/7.15.0/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/7.15.0/firebase-firestore.js"></script>
<script>
    const firebaseConfig = {
apiKey: "AIzaSyDNaNRZSLk96eHP9_4JQ7HYubpCnVq8IAc",
authDomain: "bicycle-app-f3005.firebaseapp.com",
databaseURL: "https://bicycle-app-f3005.firebaseio.com",
projectId: "bicycle-app-f3005",
storageBucket: "bicycle-app-f3005.appspot.com",
messagingSenderId: "19986827976",
appId: "1:19986827976:web:41f47defbff90c481b33fd"
};
firebase.initializeApp(firebaseConfig);
const handleSigninBtn= (e)=>{
    e.preventDefault();
    document.querySelector('#spinner').style.display = "block";
    console.log("clicked");
    const email = document.querySelector("#emailLogin").value;
    const pass = document.querySelector("#passwordLogin").value;
    firebase.auth().signInWithEmailAndPassword(email, pass)
    .then(user=>{
        console.log(user);
        console.log("logedin");
        var storage = window.localStorage;
        storage.setItem("UserEmail",user.user.email );
        if(user.user.displayName) storage.setItem("UserName",user.user.displayName );
        else storage.setItem("UserName",user.user.email.split('@')[0] );
        console.log("saved in local ",storage.getItem("UserEmail"));
        console.log("saved in local ",storage.getItem("UserName"));

        document.querySelector('#spinner').style.display = "none";
        window.location.href = "home.html";

    })
    .catch(function(error) {
        // Handle Errors here.
        console.log(error.message);
        var errorCode = error.code;
        var errorMessage = error.message;
        document.querySelector('#spinner').style.display = "none";
        // ...
      });
}
</script>
</html>
